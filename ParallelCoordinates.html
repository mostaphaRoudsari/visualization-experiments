<!DOCTYPE html>

<html>
	
	<head>
		<!-- Here are the examples that I used:
			http://www.columbia.edu/~cme2126/datavisuals/bigdata_parallelcoordinates.html
			https://syntagmatic.github.io/parallel-coordinates/

		-->

		<title>Parallel Coordinates</title>

		<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script> <!-- D3 -->

		<script src = "./pc_source_files/d3/d3.parcoords.js"></script> <!-- D3 Parallel Coordinates Library -->
		<link rel="stylesheet" type="text/css" href="./pc_source_files/css/d3.parcoords.css"> <!-- D3 Parallel Coordinates CSS -->

		<script src="./pc_source_files/d3/d3.underscore.math.js"></script>

    	<script src="./pc_source_files/d3/d3.divgrid.js"></script> <!-- D3 table grid -->

    	<style>
			
			
			#wrapper {
			   position: relative;
			   float: left;
			   top: 20px;
			   font-family: sans-serif;
			   font-size: 10px;
			}
			

    	</style>
	</head>
	
	<body>
		
		<div id="title">
      			<span class="large">Parallel Coordinates</span>
      	</div>
    	<div id="gap" style="width:100%;height:40px">
    	<div id="wrapper" class="parcoords" style="width:100%;height:340px">

		<script>

			// create global variables so I can access chart and data later
			var graph,
				initialData;

			var color_set = d3.scale.linear()
				.range(["#3182bd", "#f33"]);
				//.interpolate(d3.interpolateLab);

			// load data
			// this file is manually edited. I need to add some mapping later to get the data from a clean file
			d3.csv("https://dl.dropboxusercontent.com/u/16228160/equestResults.csv", function(data){

				initialData = data;

				// get parallel coordinates
				graph = d3.parcoords()('#wrapper')
                	.data(data)
                		.margin({ top: 75, left: 75, bottom: 10, right: 0 })
                		.alpha(0.4)
                		.mode("queue")
                		.rate(5)
                		.render()
                		.brushMode("1D-axes")  // enable brushing
                		.interactive();

                
                // set the initial coloring
                update_colors(d3.keys(data[0])[2]);

                 // click label to activate coloring
				graph.svg.selectAll(".dimension")
				    .on("click", update_colors)
				    .selectAll(".label")
				    	.style("font-size", "14px"); // change font sizes of selected lable

			});


			// update color and font weight of chart based on axis selection
            // modified from here: https://syntagmatic.github.io/parallel-coordinates/
            function update_colors(dimension) { 
				// change the fonts to bold
				graph.svg.selectAll(".dimension")
					.style("font-weight", "normal")
					.filter(function(d) { return d == dimension; })
						.style("font-weight", "bold");

				// change color of lines
				// set domain of color scale
				var values = graph.data().map(function(d){return parseFloat(d[dimension])}); 
				color_set.domain([d3.min(values), d3.max(values)]);
				
				// change colors for each line
				graph.color(function(d){return color_set([d[dimension]])}).render();
			};

		</script>

	</body>

</html>